<!doctype html>


    
    
    Rscripts pp
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2c2f33;
            color: white;
            margin: 0;
            padding: 0;
        }

        h1 {
            text-align: center;
        }

        select, input {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px; /* Squircle effect */
            width: calc(100% - 22px); /* Full width minus padding */
        }

        button {
            background-color: #7289da;
            border: none;
            color: white;
            padding: 10px;
            cursor: pointer;
            width: 100%;
            border-radius: 5px; /* Squircle effect */
        }

        button:hover {
            background-color: #5b6eae;
        }

        #scripts-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
        }

        .script-item {
            background-color: #40444b; /* Background for script items */
            padding: 10px;
            border-radius: 5px; /* Squircle effect */
        }

        textarea {
            width: 100%;
            height: 60px; /* Height for comment box */
            border-radius: 5px; /* Squircle effect */
            border: none; /* Remove default border */
        }
    </style>


    <h1>boxclip</h1>

    <select id="scriptType" onchange="fetchScripts()">
        <option value="latest" />Latest Scripts
    </select>

    <button onclick="fetchScripts()">Fetch Latest Scripts</button>
    <button onclick="fetchTrendingScripts()">Fetch Trending Scripts</button>

    <!-- Search Box and Button -->
    <input type="text" id="searchBox" placeholder="Search scripts..." />
    <button onclick="searchScripts()">Search</button>

    <div id="scripts-container"></div>

    <script>
        let allScripts = []; // Store all fetched scripts for searching

        async function fetchScripts() {
            const url = 'https://rscripts.net/api/v2/scripts?page=1&orderBy=date&sort=desc';
            const response = await fetch(url);
            
            if (response.ok) {
                const data = await response.json();
                console.log("Current Page:", data.info.currentPage);
                console.log("Max Pages:", data.info.maxPages);
                allScripts = data.scripts; // Store scripts for searching
                displayScripts(allScripts); // Display all fetched scripts
            } else {
                alert('Failed to fetch latest scripts!');
                console.error('Error fetching scripts:', response.statusText);
            }
        }

        async function fetchTrendingScripts() {
            const url = 'https://rscripts.net/api/v2/trending';
            const response = await fetch(url);
            
            if (response.ok) {
                const data = await response.json();
                if (data.success) {
                    console.log("Trending Scripts:", data.success);
                    allScripts = data.scripts; // Store scripts for searching
                    displayScripts(allScripts); // Display all fetched scripts
                } else {
                    console.error("Error:", data.error);
                    alert('Failed to fetch trending scripts!');
                }
            } else {
                alert('Failed to fetch trending scripts!');
                console.error('Error fetching scripts:', response.statusText);
            }
        }

        function displayScripts(scripts) {
            const scriptsContainer = document.getElementById('scripts-container');
            scriptsContainer.innerHTML = ''; // Clear previous scripts

            scripts.forEach(script => {
                const scriptItem = document.createElement('div');
                scriptItem.classList.add('script-item');
                scriptItem.innerHTML = `
                    <h2>${script.title}</h2>
                    <p>${script.description}</p>
                    <img style="width: 40px; height: 40px; border-radius: 50%;" src="${script.user?.image || 'https://i.pravatar.cc/300'}" alt="Profile picture of ${script.user?.username || script.creator}">
                    <p>Creator: ${script.user?.username || script.creator}</p>
                    <img src="${script.image}" alt="${script.title}">
                    <textarea id="script-${script._id}" placeholder="Script content will appear here..."></textarea>
                `;

                const downloadUrl = script.rawScript;

                // Fetch and display the script content
                fetch(downloadUrl)
                    .then((response) => response.text())
                    .then((scriptContent) => {
                        const textArea = scriptItem.querySelector(`#script-${script._id}`);
                        textArea.value = scriptContent;
                    })
                    .catch((error) => {
                        console.error(`Error fetching script content for ${script.title}:`, error);
                    });

                scriptsContainer.appendChild(scriptItem);
            });
        }

        function searchScripts() {
            const query = document.getElementById('searchBox').value.toLowerCase();
            
            // Filter the stored scripts based on the search query
            const filteredScripts = allScripts.filter(script => 
                script.title.toLowerCase().includes(query) || 
                script.description.toLowerCase().includes(query)
            );

            displayScripts(filteredScripts); // Display filtered scripts
        }
    </script>

</!doctype>
